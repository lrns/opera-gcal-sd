<!DOCTYPE html>
<html lang="en">
	<head>
		<link rel="stylesheet" type="text/css" href="style.css" />
		<script type="text/javascript" src="prefs.js"></script>
		<script type="text/javascript" src="main.js"></script>
		<script>
			function pad(s) {
				return s < 10 ? '0'+s : s;
			}
function init() {
	console.log('start');
	var feed = "<?xml version='1.0' encoding='UTF-8'?><feed xmlns='http://www.w3.org/2005/Atom' xmlns:openSearch='http://a9.com/-/spec/opensearchrss/1.0/' xmlns:gCal='http://schemas.google.com/gCal/2005' xmlns:gd='http://schemas.google.com/g/2005'><id>http://www.google.com/calendar/feeds/default/private/embed</id><updated>2011-06-01T21:45:04.000Z</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/g/2005#event'/><title type='text'>my default</title><subtitle type='text'>my default</subtitle><link rel='alternate' type='text/html' href='https://www.google.com/calendar/embed?src=lorenco@gmail.com'/><author><name>Laurynas Šukys</name><email>lorenco@gmail.com</email></author><generator version='1.0' uri='http://www.google.com/calendar'>Google Calendar</generator><openSearch:totalResults>8</openSearch:totalResults><openSearch:startIndex>1</openSearch:startIndex><openSearch:itemsPerPage>10</openSearch:itemsPerPage><gCal:timezone value='Europe/London'/><gCal:timesCleaned value='0'/><gd:where valueString='Newcastle upon Tyne'/><entry><id>coq4b92k6cbrp28d2sasmfbdnk</id><title type='html'>Wed 29 Jun PARIS!!!</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=Y29xNGI5Mms2Y2JycDI4ZDJzYXNtZmJkbmsgbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-06-30' startTime='2011-06-29'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>arr7al1nvm7665j7v3unb6lunk</id><title type='html'>Wed 29 Jun 15:50 Newcastle &amp;gt; Paris CDG</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=YXJyN2FsMW52bTc2NjVqN3YzdW5iNmx1bmsgbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-06-29T18:35:00.000+01:00' startTime='2011-06-29T15:50:00.000+01:00'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>jbbte21hrv74b3uagq450m001k</id><title type='html'>Mon 4 Jul 21:45 Paris CDG &amp;gt; Newcastle</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=amJidGUyMWhydjc0YjN1YWdxNDUwbTAwMWsgbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/>";
	feed += "<gd:where valueString=''/><gd:when endTime='2011-07-04T22:20:00.000+01:00' startTime='2011-07-04T21:45:00.000+01:00'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>m6n96srf9jbv2pi98v6eubg61o</id><title type='html'>Sun 10 Jul RENT £139.46</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=bTZuOTZzcmY5amJ2MnBpOTh2NmV1Ymc2MW8gbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-07-11' startTime='2011-07-10'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>tgtpi88vn1uj7554893lhap3ck</id><title type='html'>Mon 11 Jul 17:30 Congregation</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=dGd0cGk4OHZuMXVqNzU1NDg5M2xoYXAzY2sgbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/>";
	feed += " <gd:when endTime='2011-07-11T18:30:00.000+01:00' startTime='2011-07-11T17:30:00.000+01:00'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>l6rumecfvsmsbocfi77dipi0ro</id><title type='html'>Wed 13 Jul 21:55 Newcastle &amp;gt; Edinburgh</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=bDZydW1lY2Z2c21zYm9jZmk3N2RpcGkwcm8gbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-07-13T23:33:00.000+01:00' startTime='2011-07-13T21:55:00.000+01:00'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>ejsjsbce6e56o6nlocsitutdqk</id><title type='html'>Thu 14 Jul 08:10 Edinburgh &amp;gt; Kaunas</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=ZWpzanNiY2U2ZTU2bzZubG9jc2l0dXRkcWsgbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-07-14T12:55:00.000+01:00' startTime='2011-07-14T08:10:00.000+01:00'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>uerj17acekhml60c7mjmn92me8</id><title type='html'>Fri 2 Sep RENT ends</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=dWVyajE3YWNla2htbDYwYzdtam1uOTJtZTggbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-09-03' startTime='2011-09-02'><gd:reminder method='alert' minutes='10'/></gd:when></entry><entry><id>1t3sk4q8cpqk5ik6h9sqdqn54c</id><title type='html'>Mon 5 Sep JPM London training</title><content type='html'/><link rel='alternate' type='text/html' href='https://www.google.com/calendar/event?eid=MXQzc2s0cThjcHFrNWlrNmg5c3FkcW41NGMgbG9yZW5jb0Bt'/><gd:eventStatus value='http://schemas.google.com/g/2005#event.confirmed'/><gd:where valueString=''/><gd:when endTime='2011-09-06' startTime='2011-09-05'><gd:reminder method='alert' minutes='10'/></gd:when></entry></feed>";

	var parser = new DOMParser();
	var xml = parser.parseFromString(feed,"text/xml");
	xmlEntries = xml.getElementsByTagName("entry");
	var allEntries = new Array(xmlEntries.length);
	for (var i = 0; i < xmlEntries.length; i++) {
		var title = xmlEntries[i].getElementsByTagName('title')[0].childNodes[0].nodeValue;
		var start = xmlEntries[i].getElementsByTagName('gd:when')[0].attributes["startTime"].nodeValue;
		var end = xmlEntries[i].getElementsByTagName('gd:when')[0].attributes["endTime"].nodeValue;
		allEntries[i] = { 'title' : title, 'start' : new Date(start), 'end' : new Date(end) };
	}
	entries = {};
	for (var i = 0; i < allEntries.length; i++) {
		var e = allEntries[i];
		var key = e.start.getFullYear() + '-' + pad(e.start.getMonth()) + '-' + pad(e.start.getDate());
		if (key in entries) {
			entries[key].push(e);
		} else {
			entries[key] = [e];
		}
	}

}
function init2() {
	var feed = "<?xml version='1.0' encoding='UTF-8'?><feed xmlns='http://www.w3.org/2005/Atom' xmlns:openSearch='http://a9.com/-/spec/opensearchrss/1.0/' xmlns:gCal='http://schemas.google.com/gCal/2005' xmlns:gd='http://schemas.google.com/g/2005'><id>http://www.google.com/calendar/feeds/default/allcalendars/full</id><updated>2011-06-10T22:24:45.635Z</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/gCal/2005#calendarmeta'/><title type='text'>lorenco@gmail.com's Calendar List</title><link rel='alternate' type='text/html' href='https://www.google.com/calendar/render'/><link rel='http://schemas.google.com/g/2005#feed' type='application/atom+xml' href='https://www.google.com/calendar/feeds/default/allcalendars/full'/><link rel='http://schemas.google.com/g/2005#post' type='application/atom+xml' href='https://www.google.com/calendar/feeds/default/allcalendars/full'/><link rel='self' type='application/atom+xml' href='https://www.google.com/calendar/feeds/default/allcalendars/full'/><author><name>lorenco@gmail.com</name><email>lorenco@gmail.com</email></author><generator version='1.0' uri='http://www.google.com/calendar'>Google Calendar</generator><openSearch:startIndex>1</openSearch:startIndex><entry><id>http://www.google.com/calendar/feeds/default/allcalendars/full/lorenco%40gmail.com</id>";
	feed += "<published>2011-06-10T22:24:45.629Z</published><updated>2011-06-10T21:58:12.000Z</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/gCal/2005#calendarmeta'/><title type='text'>my default</title><content type='application/atom+xml' src='https://www.google.com/calendar/feeds/lorenco%40gmail.com/private/full'/><link rel='alternate' type='application/atom+xml' href='https://www.google.com/calendar/feeds/lorenco%40gmail.com/private/full'/><link rel='http://schemas.google.com/gCal/2005#eventFeed' type='application/atom+xml' href='https://www.google.com/calendar/feeds/lorenco%40gmail.com/private/full'/><link rel='http://schemas.google.com/acl/2007#accessControlList' type='application/atom+xml' href='https://www.google.com/calendar/feeds/lorenco%40gmail.com/acl/full'/><link rel='self' type='application/atom+xml' href='https://www.google.com/calendar/feeds/default/allcalendars/full/lorenco%40gmail.com'/><author><name>lorenco@gmail.com</name><email>lorenco@gmail.com</email></author><gCal:accesslevel value='owner'/><gCal:color value='#29527A'/><gCal:hidden value='false'/><gd:where valueString='Newcastle upon Tyne'/><gCal:selected value='true'/><gCal:timezone value='Europe/London'/><gCal:timesCleaned value='0'/></entry><entry><id>http://www.google.com/calendar/feeds/default/allcalendars/full/n05cenkdgkmb1giq7ochipudng%40group.calendar.google.com</id><published>2011-06-10T22:24:45.630Z</published><updated>2011-05-31T05:08:53.000Z</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/gCal/2005#calendarmeta'/><title type='text'>timetable</title><summary type='text'>Uni timetable </summary><content type='application/atom+xml' src='https://www.google.com/calendar/feeds/n05cenkdgkmb1giq7ochipudng%40group.calendar.google.com/private/full'/><link rel='alternate' type='application/atom+xml' href='https://www.google.com/calendar/feeds/n05cenkdgkmb1giq7ochipudng%40group.calendar.google.com/private/full'/><link rel='http://schemas.google.com/gCal/2005#eventFeed' type='application/atom+xml' href='https://www.google.com/calendar/feeds/n05cenkdgkmb1giq7ochipudng%40group.calendar.google.com/private/full'/><link rel='http://schemas.google.com/acl/2007#accessControlList' type='application/atom+xml' href='https://www.google.com/calendar/feeds/n05cenkdgkmb1giq7ochipudng%40group.calendar.google.com/acl/full'/><link rel='self' type='application/atom+xml' href='https://www.google.com/calendar/feeds/default/allcalendars/full/n05cenkdgkmb1giq7ochipudng%40group.calendar.google.com'/><author><name>timetable</name></author>";
	feed += "<gCal:accesslevel value='owner'/><gCal:color value='#BE6D00'/><gCal:hidden value='false'/><gd:where valueString='Newcastle upon Tyne'/><gCal:selected value='true'/><gCal:timezone value='Europe/London'/><gCal:timesCleaned value='0'/></entry><entry><id>http://www.google.com/calendar/feeds/default/allcalendars/full/en.uk%23holiday%40group.v.calendar.google.com</id><published>2011-06-10T22:24:45.629Z</published><updated>2011-06-10T22:11:00.000Z</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/gCal/2005#calendarmeta'/><title type='text'>UK Holidays</title><summary type='text'>UK Holidays</summary><content type='application/atom+xml' src='https://www.google.com/calendar/feeds/en.uk%23holiday%40group.v.calendar.google.com/private/full'/><link rel='alternate' type='application/atom+xml' href='https://www.google.com/calendar/feeds/en.uk%23holiday%40group.v.calendar.google.com/private/full'/><link rel='http://schemas.google.com/gCal/2005#eventFeed' type='application/atom+xml' href='https://www.google.com/calendar/feeds/en.uk%23holiday%40group.v.calendar.google.com/private/full'/><link rel='self' type='application/atom+xml' href='https://www.google.com/calendar/feeds/default/allcalendars/full/en.uk%23holiday%40group.v.calendar.google.com'/><author><name>UK Holidays</name></author><gCal:accesslevel value='read'/><gCal:color value='#A32929'/><gCal:hidden value='false'/><gCal:selected value='true'/><gCal:timezone value='Europe/London'/><gCal:timesCleaned value='0'/></entry></feed>";

	var parser = new DOMParser();
	var xml = parser.parseFromString(feed,"text/xml");
	var xmlEntries = xml.getElementsByTagName("entry");
	var entries = new Array(xmlEntries.length);

	for (var i = 0; i < xmlEntries.length; i++) {
		var title = xmlEntries[i].getElementsByTagName('title')[0].childNodes[0].nodeValue;
		var url = xmlEntries[i].getElementsByTagName('content')[0].attributes["src"].nodeValue;
		var color = xmlEntries[i].getElementsByTagName('gCal:color')[0].attributes["value"].nodeValue;
		entries[i] = { 'url' : url, 'title' : title, 'color' : color };
	}
	console.log(entries);
}
			window.addEventListener('load', init, false);
		</script>
	</head>
	<body>
		<div id="cal">Google Calendar</div>
	</body>
</html>
